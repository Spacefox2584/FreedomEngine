<!-- core/index.html -->
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>FreedomEngine</title>
    <link rel="stylesheet" href="./style.css" />
    <!-- R4: layout modes (separate file, minimal risk) -->
    <link rel="stylesheet" href="./layout.css" />
  </head>

  <body data-theme="dark" data-layout="compact">
    <div id="fe-app" class="app">
      <header class="topbar">
        <div class="brand">
          <div class="mark">FE</div>
          <div class="brand-text">
            <div class="brand-name">FreedomEngine</div>
            <div class="brand-sub">Shell v0.1</div>
          </div>
        </div>

        <div class="spaces" id="fe-spaces" aria-label="Spaces"></div>

        <div class="topbar-right">
          <button class="btn ghost" id="fe-btn-account" title="Sign in">
            Sign in
          </button>

          <button class="btn ghost" id="fe-btn-layout" title="Toggle layout mode">
            Layout
          </button>

          <button class="btn ghost" id="fe-btn-changelog" title="View changelog">
            Changelog
          </button>
          <button class="btn ghost" id="fe-btn-feedback" title="Send feedback">
            Feedback
          </button>

          <button class="btn ghost" id="fe-toggle-theme" title="Toggle theme">
            Theme
          </button>

          <div class="status" id="fe-status" title="Status">
            <span class="dot" aria-hidden="true"></span>
            <span class="status-text">Local</span>
          </div>
        </div>
      </header>

      <main class="main">
        <section class="workspace" aria-label="Workspace">
          <div id="fe-mount" class="mount"></div>
        </section>

        <aside class="pane" id="fe-pane" aria-label="Detail pane" data-open="0">
          <div class="pane-header">
            <div class="pane-title" id="fe-pane-title">Details</div>
            <button class="btn ghost small" id="fe-pane-close" title="Close pane">
              Close
            </button>
          </div>
          <div class="pane-body" id="fe-pane-body"></div>
        </aside>
      </main>

      <footer class="bottombar">
        <div class="footer-left">
          <div class="hint">
            <span class="kbd">Ctrl</span> + <span class="kbd">K</span> reserved
            (later). URL state is live now.
          </div>
          <div class="footer-actions">
            <button class="btn ghost small" id="fe-inspect-toggle">Inspect</button>
            <button
              class="btn ghost small"
              id="fe-snapshot-now"
              title="Force a snapshot now (dev)"
            >
              Snapshot
            </button>
          </div>
        </div>

        <div class="hint" id="fe-route-hint"></div>
      </footer>

      <div class="inspector" id="fe-inspector" data-open="0" aria-label="State inspector">
        <div class="inspector-head">
          <div class="inspector-title">State Inspector</div>
          <button class="btn ghost small" id="fe-inspect-close">Close</button>
        </div>
        <pre class="inspector-body" id="fe-inspect-body"></pre>
      </div>
    </div>

    <!-- AUTH OVERLAY (R6.4) -->
    <div id="fe-auth-overlay" class="fe-auth-overlay" data-open="0" aria-hidden="true" data-step="login">
      <div class="fe-auth-modal" role="dialog" aria-modal="true" aria-label="Sign in">
        <div class="fe-auth-title">Sign in</div>
        <div class="fe-auth-sub">Business login</div>

        <label class="fe-auth-label">
          Email
          <input
            id="fe-auth-email"
            class="fe-auth-input"
            type="email"
            autocomplete="email"
            placeholder="you@company.com"
          />
        </label>

        <label class="fe-auth-label">
          Password
          <input
            id="fe-auth-pass"
            class="fe-auth-input"
            type="password"
            autocomplete="current-password"
            placeholder="••••••••"
          />
        </label>

        <button id="fe-auth-login" class="btn primary fe-auth-btn">Sign in</button>
        <div id="fe-auth-msg" class="fe-auth-msg"></div>

        <!-- STAFF PICKER -->
        <div id="fe-staff-wrap" class="fe-staff-wrap" style="display:none">
          <div class="fe-staff-header">
            <div id="fe-staff-title" class="fe-staff-title">Choose staff</div>
            <button id="fe-staff-back" class="btn ghost small" type="button">Back</button>
          </div>

          <div id="fe-staff-hint" class="fe-staff-hint">Select who you are.</div>

          <div id="fe-staff-grid" class="fe-staff-grid"></div>

          <div id="fe-staff-pin-wrap" class="fe-staff-pin-wrap" style="display:none">
            <label class="fe-auth-label">
              Staff PIN
              <input id="fe-staff-pin" class="fe-auth-input" type="password" inputmode="numeric" placeholder="4 digits" />
            </label>
            <button id="fe-staff-pin-confirm" class="btn primary fe-auth-btn" type="button">Enter</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Supabase UMD -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>

    <!-- FE runtime env (window.FE_ENV) -->
    <script src="./runtime-env.js"></script>

    <!-- Boot FE -->
    <script type="module" src="./app.js"></script>
  </body>
</html>
